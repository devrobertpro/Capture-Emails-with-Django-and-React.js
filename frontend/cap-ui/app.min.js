'use strict';const e=React.createElement,useEffect=React.useEffect,useState=React.useState,rootURL="http://127.0.0.1:8000",getCookies=a=>{// vanilla javascript
// docs have jquery
var b={};return document.cookie&&""!==document.cookie&&document.cookie.split(";").forEach(function(a){var c=a.trim().match(/(\w+)=(.*)/);void 0!==c&&(b[c[1]]=decodeURIComponent(c[2]))}),a?b[a]:b},useDisplayMsg=()=>{const[a,b]=useState(""),[c,d]=useState(!1),e=(a,c)=>{b(a);d("true"===c+"")};return useEffect(()=>{let b;if(""!==a){const a=c?20000:5000;b=setTimeout(()=>{e("",!1)},a)}return()=>{clearTimeout(b)}}),[a,c,e]},CaptureEmailUI=a=>{const[b,c]=useState(""),[d,e,f]=useDisplayMsg(),{config:g}=a;return React.createElement("form",{className:g.formClass,onSubmit:a=>{a.preventDefault();const d=getCookies("csrftoken");if(d||f("This is not a valid embed.",!0),""===b||void 0===b||null===b)return void f("Value is required",!0);// send to backend!
const e=JSON.stringify({email:b}),g=new XMLHttpRequest;g.open("POST",`${rootURL}/api/capture/email/`,!0),g.setRequestHeader("Content-Type","application/json"),g.setRequestHeader("X-CSRFTOKEN",d),g.onerror=()=>{f("Error! Please try again later.",!0)},g.onload=()=>{201===g.status?(c(""),f("Success! You email is saved.",!1)):f("Error! Please try again.",!0)},g.send(e)}},!e&&d&&React.createElement("div",{className:g.successClass?g.successClass:"alert alert-success"},d),React.createElement("input",{className:g.inputClass,value:b,onChange:a=>{c(a.target.value),f("",!1)},type:"email",placeholder:"your email",required:!0}),e&&d&&React.createElement("p",{className:g.errorClass},d),"false"===g.btnShow?"":React.createElement("p",null,React.createElement("button",{className:g.btnClass,type:"submit"},"Save Email")))};// Find all DOM containers, and render our component into them.
var containers=document.querySelectorAll(".cap-ui");containers.forEach(a=>{// render the component into the DOM
ReactDOM.render(e(CaptureEmailUI,{config:a.dataset}),a)});
